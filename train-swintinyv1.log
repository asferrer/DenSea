nohup: ignoring input
['/app/DiffusionDet', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages', '/content/DiffusionDet/detectron2']
Command Line Args: Namespace(config_file='configs/diffdet.densea.swintinyv1.yaml', resume=True, eval_only=False, num_gpus=1, num_machines=1, machine_rank=0, dist_url='tcp://127.0.0.1:49152', opts=[])
[09/30 18:41:28 detectron2]: Rank of current process: 0. World size: 1
[09/30 18:41:28 detectron2]: Environment info:
-------------------------------  -----------------------------------------------------------------
sys.platform                     linux
Python                           3.10.12 (main, Sep 11 2024, 15:47:36) [GCC 11.4.0]
numpy                            1.26.3
detectron2                       0.6 @/usr/local/lib/python3.10/dist-packages/detectron2
Compiler                         GCC 11.4
CUDA compiler                    not available
DETECTRON2_ENV_MODULE            <not set>
PyTorch                          2.4.1+cu121 @/usr/local/lib/python3.10/dist-packages/torch
PyTorch debug build              False
torch._C._GLIBCXX_USE_CXX11_ABI  False
GPU available                    Yes
GPU 0                            NVIDIA GeForce RTX 4080 Laptop GPU (arch=8.9)
Driver version                   560.70
CUDA_HOME                        /usr/local/cuda
Pillow                           10.2.0
torchvision                      0.19.1+cu121 @/usr/local/lib/python3.10/dist-packages/torchvision
torchvision arch flags           5.0, 6.0, 7.0, 7.5, 8.0, 8.6, 9.0
fvcore                           0.1.5.post20221221
iopath                           0.1.9
cv2                              Not found
-------------------------------  -----------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.4.2 (Git Hash 1137e04ec0b5251ca2b4400a4fd3c667ce843d67)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 12.1
  - NVCC architecture flags: -gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 90.1  (built against CUDA 12.4)
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=12.1, CUDNN_VERSION=9.1.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=2.4.1, USE_CUDA=ON, USE_CUDNN=ON, USE_CUSPARSELT=1, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_GLOO=ON, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, USE_ROCM_KERNEL_ASSERT=OFF, 

[09/30 18:41:28 detectron2]: Command line arguments: Namespace(config_file='configs/diffdet.densea.swintinyv1.yaml', resume=True, eval_only=False, num_gpus=1, num_machines=1, machine_rank=0, dist_url='tcp://127.0.0.1:49152', opts=[])
[09/30 18:41:28 detectron2]: Contents of args.config_file=configs/diffdet.densea.swintinyv1.yaml:
_BASE_: "Base-DiffusionDet.yaml"
MODEL:
  WEIGHTS: "models/swin_tiny_patch4_window7_224.pth"  # Usar los pesos preentrenados de Swin Tiny
  BACKBONE:
    NAME: build_swintransformer_fpn_backbone
    FREEZE_AT: 0
  SWIN:
    SIZE: T  # Indica Swin Tiny
  FPN:
    IN_FEATURES: ["swin0", "swin1", "swin2", "swin3"]
  DiffusionDet:
    NUM_PROPOSALS: 300
    NUM_CLASSES: 20
  MASK_ON: False
  ROI_HEADS:
    NUM_CLASSES: 20
    BATCH_SIZE_PER_IMAGE: 128  # Ajustado a 128 para reducir el uso de memoria
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.12, 57.375]
DATASETS:
  TRAIN: ("cleansea_train", "synthetic_v1",)
  TEST:  ("cleansea_test",)
DATALOADER:
  NUM_WORKERS: 2  # Reducido para evitar la saturación de la GPU y CPU
SOLVER:
  OPTIMIZER: "ADAMW"
  BASE_LR: 0.000075  # Tasa de aprendizaje ajustada para Swin Tiny
  WEIGHT_DECAY: 0.05
  IMS_PER_BATCH: 2  # Disminuido para adaptarse mejor a la memoria de la T4
  MAX_ITER: 50000  # Mantener número de iteraciones
  STEPS: (35000, 45000)
  WARMUP_FACTOR: 0.001
  WARMUP_ITERS: 1000
  CHECKPOINT_PERIOD: 1000
  GAMMA: 0.1
  CLIP_GRADIENTS:
    ENABLED: True
    CLIP_VALUE: 1.0
  AMP:
    ENABLED: False  # Activar AMP para acelerar y reducir el consumo de memoria
  
TEST:
  EVAL_PERIOD: 500
OUTPUT_DIR: "./output/swintiny_densea_v1"

[09/30 18:41:28 detectron2]: Running with full config:
CUDNN_BENCHMARK: false
DATALOADER:
  ASPECT_RATIO_GROUPING: true
  FILTER_EMPTY_ANNOTATIONS: false
  NUM_WORKERS: 2
  REPEAT_SQRT: true
  REPEAT_THRESHOLD: 0.0
  SAMPLER_TRAIN: TrainingSampler
DATASETS:
  PRECOMPUTED_PROPOSAL_TOPK_TEST: 1000
  PRECOMPUTED_PROPOSAL_TOPK_TRAIN: 2000
  PROPOSAL_FILES_TEST: []
  PROPOSAL_FILES_TRAIN: []
  TEST:
  - cleansea_test
  TRAIN:
  - cleansea_train
  - synthetic_v1
FLOAT32_PRECISION: ''
GLOBAL:
  HACK: 1.0
INPUT:
  CROP:
    ENABLED: false
    SIZE:
    - 384
    - 600
    TYPE: absolute_range
  FORMAT: RGB
  MASK_FORMAT: polygon
  MAX_SIZE_TEST: 1333
  MAX_SIZE_TRAIN: 1333
  MIN_SIZE_TEST: 800
  MIN_SIZE_TRAIN:
  - 480
  - 512
  - 544
  - 576
  - 608
  - 640
  - 672
  - 704
  - 736
  - 768
  - 800
  MIN_SIZE_TRAIN_SAMPLING: choice
  RANDOM_FLIP: horizontal
MODEL:
  ANCHOR_GENERATOR:
    ANGLES:
    - - -90
      - 0
      - 90
    ASPECT_RATIOS:
    - - 0.5
      - 1.0
      - 2.0
    NAME: DefaultAnchorGenerator
    OFFSET: 0.0
    SIZES:
    - - 32
      - 64
      - 128
      - 256
      - 512
  BACKBONE:
    FREEZE_AT: 0
    NAME: build_swintransformer_fpn_backbone
  DEVICE: cuda
  DiffusionDet:
    ACTIVATION: relu
    ALPHA: 0.25
    CLASS_WEIGHT: 2.0
    DEEP_SUPERVISION: true
    DIM_DYNAMIC: 64
    DIM_FEEDFORWARD: 2048
    DROPOUT: 0.0
    GAMMA: 2.0
    GIOU_WEIGHT: 2.0
    HIDDEN_DIM: 256
    L1_WEIGHT: 5.0
    NHEADS: 8
    NO_OBJECT_WEIGHT: 0.1
    NUM_CLASSES: 20
    NUM_CLS: 1
    NUM_DYNAMIC: 2
    NUM_HEADS: 6
    NUM_PROPOSALS: 300
    NUM_REG: 3
    OTA_K: 5
    PRIOR_PROB: 0.01
    SAMPLE_STEP: 1
    SNR_SCALE: 2.0
    USE_FED_LOSS: false
    USE_FOCAL: true
    USE_NMS: true
  FPN:
    FUSE_TYPE: sum
    IN_FEATURES:
    - swin0
    - swin1
    - swin2
    - swin3
    NORM: ''
    OUT_CHANNELS: 256
  KEYPOINT_ON: false
  LOAD_PROPOSALS: false
  MASK_ON: false
  META_ARCHITECTURE: DiffusionDet
  PANOPTIC_FPN:
    COMBINE:
      ENABLED: true
      INSTANCES_CONFIDENCE_THRESH: 0.5
      OVERLAP_THRESH: 0.5
      STUFF_AREA_LIMIT: 4096
    INSTANCE_LOSS_WEIGHT: 1.0
  PIXEL_MEAN:
  - 123.675
  - 116.28
  - 103.53
  PIXEL_STD:
  - 58.395
  - 57.12
  - 57.375
  PROPOSAL_GENERATOR:
    MIN_SIZE: 0
    NAME: RPN
  RESNETS:
    DEFORM_MODULATED: false
    DEFORM_NUM_GROUPS: 1
    DEFORM_ON_PER_STAGE:
    - false
    - false
    - false
    - false
    DEPTH: 50
    NORM: FrozenBN
    NUM_GROUPS: 1
    OUT_FEATURES:
    - res2
    - res3
    - res4
    - res5
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: true
    WIDTH_PER_GROUP: 64
  RETINANET:
    BBOX_REG_LOSS_TYPE: smooth_l1
    BBOX_REG_WEIGHTS: &id002
    - 1.0
    - 1.0
    - 1.0
    - 1.0
    FOCAL_LOSS_ALPHA: 0.25
    FOCAL_LOSS_GAMMA: 2.0
    IN_FEATURES:
    - p3
    - p4
    - p5
    - p6
    - p7
    IOU_LABELS:
    - 0
    - -1
    - 1
    IOU_THRESHOLDS:
    - 0.4
    - 0.5
    NMS_THRESH_TEST: 0.5
    NORM: ''
    NUM_CLASSES: 80
    NUM_CONVS: 4
    PRIOR_PROB: 0.01
    SCORE_THRESH_TEST: 0.05
    SMOOTH_L1_LOSS_BETA: 0.1
    TOPK_CANDIDATES_TEST: 1000
  ROI_BOX_CASCADE_HEAD:
    BBOX_REG_WEIGHTS:
    - &id001
      - 10.0
      - 10.0
      - 5.0
      - 5.0
    - - 20.0
      - 20.0
      - 10.0
      - 10.0
    - - 30.0
      - 30.0
      - 15.0
      - 15.0
    IOUS:
    - 0.5
    - 0.6
    - 0.7
  ROI_BOX_HEAD:
    BBOX_REG_LOSS_TYPE: smooth_l1
    BBOX_REG_LOSS_WEIGHT: 1.0
    BBOX_REG_WEIGHTS: *id001
    CLS_AGNOSTIC_BBOX_REG: false
    CONV_DIM: 256
    FC_DIM: 1024
    FED_LOSS_FREQ_WEIGHT_POWER: 0.5
    FED_LOSS_NUM_CLASSES: 50
    NAME: ''
    NORM: ''
    NUM_CONV: 0
    NUM_FC: 0
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_TYPE: ROIAlignV2
    SMOOTH_L1_BETA: 0.0
    TRAIN_ON_PRED_BOXES: false
    USE_FED_LOSS: false
    USE_SIGMOID_CE: false
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 128
    IN_FEATURES:
    - p2
    - p3
    - p4
    - p5
    IOU_LABELS:
    - 0
    - 1
    IOU_THRESHOLDS:
    - 0.5
    NAME: Res5ROIHeads
    NMS_THRESH_TEST: 0.5
    NUM_CLASSES: 20
    POSITIVE_FRACTION: 0.25
    PROPOSAL_APPEND_GT: true
    SCORE_THRESH_TEST: 0.05
  ROI_KEYPOINT_HEAD:
    CONV_DIMS:
    - 512
    - 512
    - 512
    - 512
    - 512
    - 512
    - 512
    - 512
    LOSS_WEIGHT: 1.0
    MIN_KEYPOINTS_PER_IMAGE: 1
    NAME: KRCNNConvDeconvUpsampleHead
    NORMALIZE_LOSS_BY_VISIBLE_KEYPOINTS: true
    NUM_KEYPOINTS: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_TYPE: ROIAlignV2
  ROI_MASK_HEAD:
    CLS_AGNOSTIC_MASK: false
    CONV_DIM: 256
    NAME: MaskRCNNConvUpsampleHead
    NORM: ''
    NUM_CONV: 0
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_TYPE: ROIAlignV2
  RPN:
    BATCH_SIZE_PER_IMAGE: 256
    BBOX_REG_LOSS_TYPE: smooth_l1
    BBOX_REG_LOSS_WEIGHT: 1.0
    BBOX_REG_WEIGHTS: *id002
    BOUNDARY_THRESH: -1
    CONV_DIMS:
    - -1
    HEAD_NAME: StandardRPNHead
    IN_FEATURES:
    - res4
    IOU_LABELS:
    - 0
    - -1
    - 1
    IOU_THRESHOLDS:
    - 0.3
    - 0.7
    LOSS_WEIGHT: 1.0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOPK_TEST: 1000
    POST_NMS_TOPK_TRAIN: 2000
    PRE_NMS_TOPK_TEST: 6000
    PRE_NMS_TOPK_TRAIN: 12000
    SMOOTH_L1_BETA: 0.0
  SEM_SEG_HEAD:
    COMMON_STRIDE: 4
    CONVS_DIM: 128
    IGNORE_VALUE: 255
    IN_FEATURES:
    - p2
    - p3
    - p4
    - p5
    LOSS_WEIGHT: 1.0
    NAME: SemSegFPNHead
    NORM: GN
    NUM_CLASSES: 54
  SWIN:
    OUT_FEATURES:
    - 0
    - 1
    - 2
    - 3
    SIZE: T
    USE_CHECKPOINT: false
  WEIGHTS: models/swin_tiny_patch4_window7_224.pth
MODEL_EMA:
  DECAY: 0.999
  DEVICE: ''
  ENABLED: false
  USE_EMA_WEIGHTS_FOR_EVAL_ONLY: false
  YOLOX: false
OUTPUT_DIR: ./output/swintiny_densea_v1
SEED: 40244023
SOLVER:
  AMP:
    ENABLED: false
  BACKBONE_MULTIPLIER: 1.0
  BASE_LR: 7.5e-05
  BASE_LR_END: 0.0
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1000
  CLIP_GRADIENTS:
    CLIP_TYPE: full_model
    CLIP_VALUE: 1.0
    ENABLED: true
    NORM_TYPE: 2.0
  GAMMA: 0.1
  IMS_PER_BATCH: 2
  LR_SCHEDULER_NAME: WarmupMultiStepLR
  MAX_ITER: 50000
  MOMENTUM: 0.9
  NESTEROV: false
  NUM_DECAYS: 3
  OPTIMIZER: ADAMW
  REFERENCE_WORLD_SIZE: 0
  RESCALE_INTERVAL: false
  STEPS:
  - 35000
  - 45000
  WARMUP_FACTOR: 0.001
  WARMUP_ITERS: 1000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.05
  WEIGHT_DECAY_BIAS: null
  WEIGHT_DECAY_NORM: 0.0
TEST:
  AUG:
    CVPODS_TTA: true
    ENABLED: false
    FLIP: true
    MAX_SIZE: 4000
    MIN_SIZES:
    - 400
    - 500
    - 600
    - 640
    - 700
    - 900
    - 1000
    - 1100
    - 1200
    - 1300
    - 1400
    - 1800
    - 800
    SCALE_FILTER: true
    SCALE_RANGES:
    - - 96
      - 10000
    - - 96
      - 10000
    - - 64
      - 10000
    - - 64
      - 10000
    - - 64
      - 10000
    - - 0
      - 10000
    - - 0
      - 10000
    - - 0
      - 256
    - - 0
      - 256
    - - 0
      - 192
    - - 0
      - 192
    - - 0
      - 96
    - - 0
      - 10000
  DETECTIONS_PER_IMAGE: 100
  EVAL_PERIOD: 500
  EXPECTED_RESULTS: []
  KEYPOINT_OKS_SIGMAS: []
  PRECISE_BN:
    ENABLED: false
    NUM_ITER: 200
VERSION: 2
VIS_PERIOD: 0

[09/30 18:41:29 detectron2]: Full config saved to ./output/swintiny_densea_v1/config.yaml
/usr/local/lib/python3.10/dist-packages/torch/functional.py:513: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3609.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
WARNING [09/30 18:41:30 d2.data.datasets.coco]: 
Category ids in annotations are not in [1, #categories]! We'll apply a mapping for you.

[09/30 18:41:30 d2.data.datasets.coco]: Loaded 989 images in COCO format from /app/DiffusionDet/datasets/cleansea/train/annotations_bbox.json
WARNING [09/30 18:41:30 d2.data.datasets.coco]: 
Category ids in annotations are not in [1, #categories]! We'll apply a mapping for you.

[09/30 18:41:30 d2.data.datasets.coco]: Loaded 990 images in COCO format from /app/DiffusionDet/datasets/synthetic/v1/annotations_bbox.json
[09/30 18:41:30 d2.data.build]: Distribution of instances among all 20 categories:
|   category    | #instances   |   category    | #instances   |   category    | #instances   |
|:-------------:|:-------------|:-------------:|:-------------|:-------------:|:-------------|
|  background   | 0            |      Can      | 1311         |  Squared_Can  | 58           |
|     Wood      | 182          |    Bottle     | 450          |  Plastic_Bag  | 2040         |
|     Glove     | 147          |  Fishing_Net  | 339          |     Tire      | 54           |
| Packaging_Bag | 672          | WashingMach.. | 2            |  Metal_Chain  | 4            |
|     Rope      | 263          |     Towel     | 163          | Plastic_Deb.. | 258          |
| Metal_Debris  | 61           |     Pipe      | 122          |     Shoe      | 33           |
|  Car_Bumper   | 230          |    Basket     | 122          |               |              |
|     total     | 6511         |               |              |               |              |
[09/30 18:41:30 d2.data.build]: Using training sampler TrainingSampler
[09/30 18:41:30 d2.data.common]: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[09/30 18:41:30 d2.data.common]: Serializing 1979 elements to byte tensors and concatenating them all ...
[09/30 18:41:30 d2.data.common]: Serialized dataset takes 3.16 MiB
[09/30 18:41:30 d2.data.build]: Making batched data loader with batch_size=2
[09/30 18:41:30 d2.checkpoint.detection_checkpoint]: [DetectionCheckpointer] Loading from ./output/swintiny_densea_v1/model_0003999.pth ...
[09/30 18:41:30 fvcore.common.checkpoint]: [Checkpointer] Loading from ./output/swintiny_densea_v1/model_0003999.pth ...
/usr/local/lib/python3.10/dist-packages/fvcore/common/checkpoint.py:252: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(f, map_location=torch.device("cpu"))
[09/30 18:41:51 fvcore.common.checkpoint]: Loading trainer from ./output/swintiny_densea_v1/model_0003999.pth ...
[09/30 18:41:51 d2.engine.hooks]: Loading scheduler from state_dict ...
[09/30 18:41:51 d2.engine.train_loop]: Starting training from iteration 4000
[09/30 18:42:07 d2.utils.events]:  eta: 9:10:46  iter: 4019  total_loss: 20.51  loss_ce: 1.298  loss_bbox: 0.6339  loss_giou: 1.074  loss_ce_0: 1.464  loss_bbox_0: 0.8647  loss_giou_0: 1.286  loss_ce_1: 1.384  loss_bbox_1: 0.7267  loss_giou_1: 1.197  loss_ce_2: 1.349  loss_bbox_2: 0.6256  loss_giou_2: 1.161  loss_ce_3: 1.304  loss_bbox_3: 0.6295  loss_giou_3: 1.051  loss_ce_4: 1.307  loss_bbox_4: 0.649  loss_giou_4: 1.117    time: 0.7261  last_time: 0.7124  data_time: 0.0155  last_data_time: 0.0035   lr: 7.5e-05  max_mem: 7747M
[09/30 18:42:22 d2.utils.events]:  eta: 9:11:14  iter: 4039  total_loss: 20.18  loss_ce: 1.329  loss_bbox: 0.6494  loss_giou: 1.112  loss_ce_0: 1.455  loss_bbox_0: 0.9912  loss_giou_0: 1.36  loss_ce_1: 1.414  loss_bbox_1: 0.7681  loss_giou_1: 1.252  loss_ce_2: 1.341  loss_bbox_2: 0.7455  loss_giou_2: 1.175  loss_ce_3: 1.321  loss_bbox_3: 0.7225  loss_giou_3: 1.204  loss_ce_4: 1.327  loss_bbox_4: 0.6879  loss_giou_4: 1.093    time: 0.7066  last_time: 0.6120  data_time: 0.0043  last_data_time: 0.0033   lr: 7.5e-05  max_mem: 7747M
[09/30 18:42:36 d2.utils.events]:  eta: 9:08:18  iter: 4059  total_loss: 20.46  loss_ce: 1.379  loss_bbox: 0.7612  loss_giou: 1.141  loss_ce_0: 1.368  loss_bbox_0: 0.8715  loss_giou_0: 1.213  loss_ce_1: 1.331  loss_bbox_1: 0.7707  loss_giou_1: 1.16  loss_ce_2: 1.396  loss_bbox_2: 0.6937  loss_giou_2: 1.129  loss_ce_3: 1.359  loss_bbox_3: 0.7504  loss_giou_3: 1.141  loss_ce_4: 1.367  loss_bbox_4: 0.7229  loss_giou_4: 1.215    time: 0.7045  last_time: 0.6673  data_time: 0.0039  last_data_time: 0.0034   lr: 7.5e-05  max_mem: 7888M
[09/30 18:42:50 d2.utils.events]:  eta: 9:04:54  iter: 4079  total_loss: 19.13  loss_ce: 1.341  loss_bbox: 0.6652  loss_giou: 0.9461  loss_ce_0: 1.482  loss_bbox_0: 0.8367  loss_giou_0: 1.301  loss_ce_1: 1.412  loss_bbox_1: 0.7993  loss_giou_1: 1.166  loss_ce_2: 1.376  loss_bbox_2: 0.664  loss_giou_2: 1.071  loss_ce_3: 1.382  loss_bbox_3: 0.6342  loss_giou_3: 1.032  loss_ce_4: 1.367  loss_bbox_4: 0.6213  loss_giou_4: 1.019    time: 0.7067  last_time: 0.8266  data_time: 0.0042  last_data_time: 0.0036   lr: 7.5e-05  max_mem: 7888M
[09/30 18:43:05 d2.utils.events]:  eta: 9:07:50  iter: 4099  total_loss: 20.54  loss_ce: 1.465  loss_bbox: 0.7693  loss_giou: 1.011  loss_ce_0: 1.544  loss_bbox_0: 0.8873  loss_giou_0: 1.157  loss_ce_1: 1.504  loss_bbox_1: 0.8175  loss_giou_1: 1.023  loss_ce_2: 1.451  loss_bbox_2: 0.7308  loss_giou_2: 0.9829  loss_ce_3: 1.494  loss_bbox_3: 0.6998  loss_giou_3: 0.9498  loss_ce_4: 1.457  loss_bbox_4: 0.7223  loss_giou_4: 0.9637    time: 0.7100  last_time: 0.7512  data_time: 0.0048  last_data_time: 0.0061   lr: 7.5e-05  max_mem: 7888M
[09/30 18:43:21 d2.utils.events]:  eta: 9:14:46  iter: 4119  total_loss: 20.17  loss_ce: 1.359  loss_bbox: 0.8399  loss_giou: 1.109  loss_ce_0: 1.444  loss_bbox_0: 0.9303  loss_giou_0: 1.214  loss_ce_1: 1.403  loss_bbox_1: 0.9601  loss_giou_1: 1.178  loss_ce_2: 1.371  loss_bbox_2: 0.8776  loss_giou_2: 1.082  loss_ce_3: 1.371  loss_bbox_3: 0.7981  loss_giou_3: 1.12  loss_ce_4: 1.367  loss_bbox_4: 0.8192  loss_giou_4: 1.114    time: 0.7162  last_time: 0.8454  data_time: 0.0048  last_data_time: 0.0038   lr: 7.5e-05  max_mem: 7888M
[09/30 18:43:35 d2.utils.events]:  eta: 9:15:32  iter: 4139  total_loss: 18.62  loss_ce: 1.313  loss_bbox: 0.6148  loss_giou: 1.053  loss_ce_0: 1.375  loss_bbox_0: 0.8917  loss_giou_0: 1.279  loss_ce_1: 1.363  loss_bbox_1: 0.7353  loss_giou_1: 1.163  loss_ce_2: 1.308  loss_bbox_2: 0.6111  loss_giou_2: 1.095  loss_ce_3: 1.314  loss_bbox_3: 0.6277  loss_giou_3: 1.026  loss_ce_4: 1.32  loss_bbox_4: 0.6334  loss_giou_4: 1.021    time: 0.7160  last_time: 0.8138  data_time: 0.0049  last_data_time: 0.0058   lr: 7.5e-05  max_mem: 7888M
[09/30 18:43:50 d2.utils.events]:  eta: 9:17:44  iter: 4159  total_loss: 21.89  loss_ce: 1.423  loss_bbox: 0.875  loss_giou: 1.183  loss_ce_0: 1.487  loss_bbox_0: 1.043  loss_giou_0: 1.288  loss_ce_1: 1.458  loss_bbox_1: 0.9495  loss_giou_1: 1.192  loss_ce_2: 1.435  loss_bbox_2: 0.8782  loss_giou_2: 1.195  loss_ce_3: 1.431  loss_bbox_3: 0.826  loss_giou_3: 1.167  loss_ce_4: 1.413  loss_bbox_4: 0.7962  loss_giou_4: 1.165    time: 0.7192  last_time: 0.6508  data_time: 0.0045  last_data_time: 0.0035   lr: 7.5e-05  max_mem: 7888M
[09/30 18:44:04 d2.utils.events]:  eta: 9:15:04  iter: 4179  total_loss: 18.88  loss_ce: 1.383  loss_bbox: 0.6606  loss_giou: 1.078  loss_ce_0: 1.408  loss_bbox_0: 0.7024  loss_giou_0: 1.101  loss_ce_1: 1.401  loss_bbox_1: 0.7285  loss_giou_1: 1.156  loss_ce_2: 1.382  loss_bbox_2: 0.6873  loss_giou_2: 1.098  loss_ce_3: 1.384  loss_bbox_3: 0.6579  loss_giou_3: 1.054  loss_ce_4: 1.335  loss_bbox_4: 0.6401  loss_giou_4: 1.069    time: 0.7160  last_time: 0.7111  data_time: 0.0048  last_data_time: 0.0047   lr: 7.5e-05  max_mem: 7888M
[09/30 18:44:19 d2.utils.events]:  eta: 9:13:48  iter: 4199  total_loss: 21  loss_ce: 1.381  loss_bbox: 0.7465  loss_giou: 1.062  loss_ce_0: 1.452  loss_bbox_0: 1.08  loss_giou_0: 1.324  loss_ce_1: 1.424  loss_bbox_1: 0.8506  loss_giou_1: 1.218  loss_ce_2: 1.394  loss_bbox_2: 0.8115  loss_giou_2: 1.169  loss_ce_3: 1.381  loss_bbox_3: 0.7831  loss_giou_3: 1.132  loss_ce_4: 1.364  loss_bbox_4: 0.8173  loss_giou_4: 1.184    time: 0.7140  last_time: 0.7489  data_time: 0.0044  last_data_time: 0.0037   lr: 7.5e-05  max_mem: 7888M
[09/30 18:44:33 d2.utils.events]:  eta: 9:11:36  iter: 4219  total_loss: 19.67  loss_ce: 1.36  loss_bbox: 0.7731  loss_giou: 1.093  loss_ce_0: 1.422  loss_bbox_0: 0.8065  loss_giou_0: 1.187  loss_ce_1: 1.34  loss_bbox_1: 0.7869  loss_giou_1: 1.062  loss_ce_2: 1.352  loss_bbox_2: 0.7366  loss_giou_2: 0.987  loss_ce_3: 1.358  loss_bbox_3: 0.766  loss_giou_3: 1.015  loss_ce_4: 1.361  loss_bbox_4: 0.7448  loss_giou_4: 1.001    time: 0.7117  last_time: 0.6134  data_time: 0.0047  last_data_time: 0.0049   lr: 7.5e-05  max_mem: 7888M
[09/30 18:44:48 d2.utils.events]:  eta: 9:11:21  iter: 4239  total_loss: 21.13  loss_ce: 1.4  loss_bbox: 0.7442  loss_giou: 1.159  loss_ce_0: 1.395  loss_bbox_0: 0.9208  loss_giou_0: 1.19  loss_ce_1: 1.365  loss_bbox_1: 0.8139  loss_giou_1: 1.091  loss_ce_2: 1.361  loss_bbox_2: 0.7548  loss_giou_2: 1.08  loss_ce_3: 1.372  loss_bbox_3: 0.7684  loss_giou_3: 1.119  loss_ce_4: 1.374  loss_bbox_4: 0.7813  loss_giou_4: 1.155    time: 0.7125  last_time: 0.7120  data_time: 0.0050  last_data_time: 0.0037   lr: 7.5e-05  max_mem: 7888M
[09/30 18:45:02 d2.utils.events]:  eta: 9:12:22  iter: 4259  total_loss: 18.83  loss_ce: 1.426  loss_bbox: 0.6218  loss_giou: 0.9353  loss_ce_0: 1.496  loss_bbox_0: 0.8368  loss_giou_0: 1.151  loss_ce_1: 1.432  loss_bbox_1: 0.7409  loss_giou_1: 1.01  loss_ce_2: 1.434  loss_bbox_2: 0.755  loss_giou_2: 0.9543  loss_ce_3: 1.451  loss_bbox_3: 0.7112  loss_giou_3: 0.931  loss_ce_4: 1.442  loss_bbox_4: 0.6697  loss_giou_4: 0.9347    time: 0.7136  last_time: 0.6082  data_time: 0.0048  last_data_time: 0.0054   lr: 7.5e-05  max_mem: 7888M
[09/30 18:45:18 d2.utils.events]:  eta: 9:13:12  iter: 4279  total_loss: 19.59  loss_ce: 1.366  loss_bbox: 0.69  loss_giou: 1.104  loss_ce_0: 1.407  loss_bbox_0: 0.8367  loss_giou_0: 1.305  loss_ce_1: 1.334  loss_bbox_1: 0.7421  loss_giou_1: 1.194  loss_ce_2: 1.309  loss_bbox_2: 0.6534  loss_giou_2: 1.117  loss_ce_3: 1.342  loss_bbox_3: 0.6184  loss_giou_3: 1.138  loss_ce_4: 1.362  loss_bbox_4: 0.6853  loss_giou_4: 1.145    time: 0.7162  last_time: 0.8339  data_time: 0.0047  last_data_time: 0.0036   lr: 7.5e-05  max_mem: 7888M
[09/30 18:45:33 d2.utils.events]:  eta: 9:12:58  iter: 4299  total_loss: 18.98  loss_ce: 1.244  loss_bbox: 0.5698  loss_giou: 1.083  loss_ce_0: 1.377  loss_bbox_0: 0.9112  loss_giou_0: 1.307  loss_ce_1: 1.323  loss_bbox_1: 0.7203  loss_giou_1: 1.22  loss_ce_2: 1.301  loss_bbox_2: 0.6384  loss_giou_2: 1.213  loss_ce_3: 1.237  loss_bbox_3: 0.63  loss_giou_3: 1.148  loss_ce_4: 1.253  loss_bbox_4: 0.5909  loss_giou_4: 1.087    time: 0.7166  last_time: 0.5758  data_time: 0.0047  last_data_time: 0.0037   lr: 7.5e-05  max_mem: 7990M
[09/30 18:45:48 d2.utils.events]:  eta: 9:14:11  iter: 4319  total_loss: 20.31  loss_ce: 1.448  loss_bbox: 0.6776  loss_giou: 1.093  loss_ce_0: 1.483  loss_bbox_0: 0.8288  loss_giou_0: 1.287  loss_ce_1: 1.46  loss_bbox_1: 0.7498  loss_giou_1: 1.214  loss_ce_2: 1.418  loss_bbox_2: 0.7  loss_giou_2: 1.123  loss_ce_3: 1.409  loss_bbox_3: 0.6693  loss_giou_3: 1.107  loss_ce_4: 1.446  loss_bbox_4: 0.6662  loss_giou_4: 1.139    time: 0.7190  last_time: 0.7896  data_time: 0.0047  last_data_time: 0.0038   lr: 7.5e-05  max_mem: 7993M
[09/30 18:46:04 d2.utils.events]:  eta: 9:15:33  iter: 4339  total_loss: 21.66  loss_ce: 1.333  loss_bbox: 0.8206  loss_giou: 1.311  loss_ce_0: 1.429  loss_bbox_0: 0.932  loss_giou_0: 1.344  loss_ce_1: 1.34  loss_bbox_1: 0.7958  loss_giou_1: 1.36  loss_ce_2: 1.331  loss_bbox_2: 0.7836  loss_giou_2: 1.295  loss_ce_3: 1.319  loss_bbox_3: 0.7849  loss_giou_3: 1.294  loss_ce_4: 1.348  loss_bbox_4: 0.7911  loss_giou_4: 1.246    time: 0.7228  last_time: 0.6940  data_time: 0.0045  last_data_time: 0.0038   lr: 7.5e-05  max_mem: 7993M
[09/30 18:46:19 d2.utils.events]:  eta: 9:14:20  iter: 4359  total_loss: 20.17  loss_ce: 1.194  loss_bbox: 0.7435  loss_giou: 1.064  loss_ce_0: 1.409  loss_bbox_0: 0.9809  loss_giou_0: 1.366  loss_ce_1: 1.315  loss_bbox_1: 0.8117  loss_giou_1: 1.203  loss_ce_2: 1.255  loss_bbox_2: 0.7259  loss_giou_2: 1.234  loss_ce_3: 1.231  loss_bbox_3: 0.7964  loss_giou_3: 1.086  loss_ce_4: 1.259  loss_bbox_4: 0.7661  loss_giou_4: 1.113    time: 0.7217  last_time: 0.6809  data_time: 0.0046  last_data_time: 0.0036   lr: 7.5e-05  max_mem: 7993M
[09/30 18:46:34 d2.utils.events]:  eta: 9:14:06  iter: 4379  total_loss: 19.04  loss_ce: 1.404  loss_bbox: 0.7032  loss_giou: 1.098  loss_ce_0: 1.383  loss_bbox_0: 0.8158  loss_giou_0: 1.315  loss_ce_1: 1.322  loss_bbox_1: 0.7437  loss_giou_1: 1.148  loss_ce_2: 1.32  loss_bbox_2: 0.7414  loss_giou_2: 1.115  loss_ce_3: 1.305  loss_bbox_3: 0.7568  loss_giou_3: 1.085  loss_ce_4: 1.392  loss_bbox_4: 0.7066  loss_giou_4: 1.12    time: 0.7216  last_time: 0.7926  data_time: 0.0049  last_data_time: 0.0033   lr: 7.5e-05  max_mem: 7993M
[09/30 18:46:49 d2.utils.events]:  eta: 9:13:41  iter: 4399  total_loss: 19.44  loss_ce: 1.388  loss_bbox: 0.6425  loss_giou: 1.093  loss_ce_0: 1.431  loss_bbox_0: 0.9391  loss_giou_0: 1.314  loss_ce_1: 1.38  loss_bbox_1: 0.8119  loss_giou_1: 1.211  loss_ce_2: 1.393  loss_bbox_2: 0.773  loss_giou_2: 1.175  loss_ce_3: 1.417  loss_bbox_3: 0.7235  loss_giou_3: 1.111  loss_ce_4: 1.416  loss_bbox_4: 0.7954  loss_giou_4: 1.155    time: 0.7217  last_time: 0.7907  data_time: 0.0044  last_data_time: 0.0049   lr: 7.5e-05  max_mem: 7993M
[09/30 18:47:03 d2.utils.events]:  eta: 9:13:14  iter: 4419  total_loss: 18.93  loss_ce: 1.312  loss_bbox: 0.7045  loss_giou: 0.9513  loss_ce_0: 1.389  loss_bbox_0: 0.9265  loss_giou_0: 1.2  loss_ce_1: 1.338  loss_bbox_1: 0.8235  loss_giou_1: 1.173  loss_ce_2: 1.286  loss_bbox_2: 0.7518  loss_giou_2: 1.013  loss_ce_3: 1.312  loss_bbox_3: 0.6959  loss_giou_3: 0.9679  loss_ce_4: 1.304  loss_bbox_4: 0.6869  loss_giou_4: 0.9777    time: 0.7210  last_time: 0.6592  data_time: 0.0052  last_data_time: 0.0055   lr: 7.5e-05  max_mem: 7993M
[09/30 18:47:18 d2.utils.events]:  eta: 9:13:22  iter: 4439  total_loss: 20.2  loss_ce: 1.405  loss_bbox: 0.7483  loss_giou: 1.013  loss_ce_0: 1.453  loss_bbox_0: 0.862  loss_giou_0: 1.276  loss_ce_1: 1.379  loss_bbox_1: 0.814  loss_giou_1: 1.111  loss_ce_2: 1.329  loss_bbox_2: 0.7917  loss_giou_2: 1.034  loss_ce_3: 1.305  loss_bbox_3: 0.749  loss_giou_3: 1.015  loss_ce_4: 1.407  loss_bbox_4: 0.7571  loss_giou_4: 1.075    time: 0.7213  last_time: 0.7724  data_time: 0.0045  last_data_time: 0.0047   lr: 7.5e-05  max_mem: 7993M
[09/30 18:47:34 d2.utils.events]:  eta: 9:16:16  iter: 4459  total_loss: 18.48  loss_ce: 1.309  loss_bbox: 0.6114  loss_giou: 0.8219  loss_ce_0: 1.456  loss_bbox_0: 0.866  loss_giou_0: 1.21  loss_ce_1: 1.323  loss_bbox_1: 0.7591  loss_giou_1: 1.074  loss_ce_2: 1.316  loss_bbox_2: 0.6535  loss_giou_2: 0.8317  loss_ce_3: 1.292  loss_bbox_3: 0.6556  loss_giou_3: 0.7991  loss_ce_4: 1.268  loss_bbox_4: 0.5673  loss_giou_4: 0.8273    time: 0.7236  last_time: 0.7566  data_time: 0.0049  last_data_time: 0.0048   lr: 7.5e-05  max_mem: 7998M
[09/30 18:47:49 d2.utils.events]:  eta: 9:16:17  iter: 4479  total_loss: 18.79  loss_ce: 1.303  loss_bbox: 0.7168  loss_giou: 0.9806  loss_ce_0: 1.322  loss_bbox_0: 0.8553  loss_giou_0: 1.229  loss_ce_1: 1.294  loss_bbox_1: 0.7742  loss_giou_1: 1.103  loss_ce_2: 1.274  loss_bbox_2: 0.701  loss_giou_2: 1.015  loss_ce_3: 1.282  loss_bbox_3: 0.6444  loss_giou_3: 0.9676  loss_ce_4: 1.267  loss_bbox_4: 0.6873  loss_giou_4: 0.9578    time: 0.7237  last_time: 0.6952  data_time: 0.0046  last_data_time: 0.0047   lr: 7.5e-05  max_mem: 7998M
WARNING [09/30 18:48:04 d2.data.datasets.coco]: 
Category ids in annotations are not in [1, #categories]! We'll apply a mapping for you.

[09/30 18:48:04 d2.data.datasets.coco]: Loaded 241 images in COCO format from /app/DiffusionDet/datasets/cleansea/test/annotations_bbox.json
[09/30 18:48:04 d2.data.build]: Distribution of instances among all 20 categories:
|   category    | #instances   |   category    | #instances   |   category    | #instances   |
|:-------------:|:-------------|:-------------:|:-------------|:-------------:|:-------------|
|  background   | 0            |      Can      | 85           |  Squared_Can  | 4            |
|     Wood      | 12           |    Bottle     | 31           |  Plastic_Bag  | 130          |
|     Glove     | 10           |  Fishing_Net  | 23           |     Tire      | 3            |
| Packaging_Bag | 41           | WashingMach.. | 0            |  Metal_Chain  | 0            |
|     Rope      | 17           |     Towel     | 11           | Plastic_Deb.. | 20           |
| Metal_Debris  | 5            |     Pipe      | 9            |     Shoe      | 2            |
|  Car_Bumper   | 15           |    Basket     | 11           |               |              |
|     total     | 429          |               |              |               |              |
[09/30 18:48:04 d2.data.dataset_mapper]: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[09/30 18:48:04 d2.data.common]: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[09/30 18:48:04 d2.data.common]: Serializing 241 elements to byte tensors and concatenating them all ...
[09/30 18:48:04 d2.data.common]: Serialized dataset takes 0.24 MiB
WARNING [09/30 18:48:04 d2.evaluation.coco_evaluation]: COCO Evaluator instantiated using config, this is deprecated behavior. Please pass in explicit arguments instead.
[09/30 18:48:04 d2.evaluation.evaluator]: Start inference on 241 batches
[09/30 18:48:05 d2.evaluation.evaluator]: Inference done 11/241. Dataloading: 0.0011 s/iter. Inference: 0.1172 s/iter. Eval: 0.0005 s/iter. Total: 0.1188 s/iter. ETA=0:00:27
[09/30 18:48:11 d2.evaluation.evaluator]: Inference done 54/241. Dataloading: 0.0016 s/iter. Inference: 0.1165 s/iter. Eval: 0.0005 s/iter. Total: 0.1188 s/iter. ETA=0:00:22
[09/30 18:48:16 d2.evaluation.evaluator]: Inference done 95/241. Dataloading: 0.0020 s/iter. Inference: 0.1176 s/iter. Eval: 0.0005 s/iter. Total: 0.1203 s/iter. ETA=0:00:17
